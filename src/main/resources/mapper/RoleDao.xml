<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tsl.erp.dao.RoleDao">
    <resultMap id="roleMap" type="com.tsl.erp.model.Role">
        <id property="rId" column="rid"/>
        <result property="role" column="rname"/>
        <result property="available" column="ravailable"/>
        <collection property="permission" ofType="com.tsl.erp.model.Permission">
            <id property="pId" column="pid"/>
            <result property="permission" column="pname"/>
            <result property="type" column="ptype"/>
            <result property="url" column="purl"/>
            <result property="percode" column="percode"/>
            <result property="parentid" column="parentid"/>
            <result property="parentids" column="parentids"/>
            <result property="sortstring" column="psortstring"/>
            <result property="available" column="pavailable"/>
        </collection>
    </resultMap>

    <select id="selectByRoleId" resultMap="roleMap">
        select r.* ,p.* from role r
        inner join role_permission rp on r.rid = rp.rp_role_id
        left join permission p on rp.rp_permission_id = p.pid
        where r.rid = #{rId}
    </select>

    <select id="selectAllRole" resultMap="roleMap">
        select r.* from role r
    </select>
</mapper>